USE testdb;

-- create employee table
CREATE TABLE employee (
    id INT AUTO_INCREMENT PRIMARY KEY,
    surname CHAR(50) NOT NULL,
    first_name CHAR(50) NOT NULL,
    address CHAR(200),
    phone CHAR(12)
);

-- create doctor table (employee_id as both PK and FK)
CREATE TABLE doctor (
    employee_id INT PRIMARY KEY,
    specialty CHAR(50) NOT NULL,
    FOREIGN KEY (employee_id) REFERENCES employee(id)
);

-- create department table
CREATE TABLE department (
    id INT AUTO_INCREMENT PRIMARY KEY,
    dep_name CHAR(100) NOT NULL,
    building CHAR(50) NOT NULL,
    doctor_id INT,
    FOREIGN KEY (doctor_id) REFERENCES doctor(employee_id)
);

-- create nurse table (employee_id as both PK and FK)
CREATE TABLE nurse (
    employee_id INT PRIMARY KEY,
    department_id INT,
    rotation CHAR(50) NOT NULL,
    salary DECIMAL(10, 2) NOT NULL,
    FOREIGN KEY (employee_id) REFERENCES employee(id),
    FOREIGN KEY (department_id) REFERENCES department(id)
);

-- create ward table
CREATE TABLE ward (
    id INT AUTO_INCREMENT PRIMARY KEY,
    ward_number INT,
    no_of_beds INT,
    nurse_id INT,
    department_id INT,
    FOREIGN KEY (nurse_id) REFERENCES nurse(employee_id),
    FOREIGN KEY (department_id) REFERENCES department(id)
);

-- create patient table
CREATE TABLE patient (
    id INT AUTO_INCREMENT PRIMARY KEY,
    first_name CHAR(50) NOT NULL,
    surname CHAR(50) NOT NULL,
    address CHAR(100),
    phone CHAR(12)
);

-- create hospitalization table
CREATE TABLE hospitalization (
    id INT AUTO_INCREMENT PRIMARY KEY,
    patient_id INT,
    ward_id INT,
    doctor_id INT,
    department_id INT,
    diagnosis CHAR(200),
    bed_number INT,
    FOREIGN KEY (patient_id) REFERENCES patient(id),
    FOREIGN KEY (ward_id) REFERENCES ward(id),
    FOREIGN KEY (doctor_id) REFERENCES doctor(employee_id),
    FOREIGN KEY (department_id) REFERENCES department(id),
    room_number INT
);

-- create transfer table
CREATE TABLE transfer (
    id INT AUTO_INCREMENT PRIMARY KEY,
    patient_id INT,
    from_hospitalization_id INT,
    to_hospitalization_id INT,
    reason CHAR(200),
    FOREIGN KEY (patient_id) REFERENCES patient(id),
    FOREIGN KEY (from_hospitalization_id) REFERENCES hospitalization(id),
    FOREIGN KEY (to_hospitalization_id) REFERENCES hospitalization(id)
);
